---
layout: post
title: ContainerLess
date: 2011-04-05
comments: false
---

<h1>{{ page.title }}</h1>
<div class='post'>
I've recently worked on a project where we built a relatively small web application for a client. There was a hard release date, which gave us less than 4 weeks to build and deliver the application. There were several things we did to ensure that we would be able to release on time. One of the them was making sure very early that we could deploy the new application into a production-like environment. During the first few days, we therefore invested time in building infrastructure to deploy the application automatically and continuously (i.e. after each build) to a production-like environment. Going through this process was useful in several different ways:<ul><li>it made us think early on in the project, what will be required to run the application in production (e.g. operating system, software, ports, certificates, etc.). This gave us sufficient time to react to unexpected obstacles;</li><br /><li>by automating the deployment process early, we reduced the number of times we had to do this activity manually later on;</li><br /><li>seeing the application work in a production-like environment was encouraging feedback that we would be able to release to production whenever our client required;</li><br /><li>deploying the application while it was still very simple allowed us to focus on the deployment process without getting distracted by problems caused by the application.</li></ul><h3>Ditching the Container</h3><p>When we first tried to deploy the application, it was not much more than a Hello World web application. We decided to use Jetty as a web server, since we had used it many times on projects before - both standalone and embedded. Whenever we used Jetty in the past, however, we would normally build a WAR file or a WAR-like directory structure, write a web deployment descriptor and finally deploy or load the artefact into Jetty.</p><p>Having spent a bit of time working on a Ruby on Rails application recently, the deployment process used in the past seemed cumbersome and complicated - even more so given the simplicity of the application at hand. That's when we realised that what we cared most about is the application itself and to a much lesser extent the container. In fact, we didn't care about the container at all. All we cared about was that our application would be able to serve incoming requests. At some point, we started to think of the application more of as a self-contained program, which just happened to expose some of its functionality via HTTP. The diagram below illustrates this mind-shift.</p><div style="text-align: center;"><a href="http://3.bp.blogspot.com/-K2lhkdG6xjI/TZrwPZm9HmI/AAAAAAAAAJQ/i014GAjqvQI/s1600/container-less.png" onblur="try {parent.deselectBloggerImageGracefully();} catch(e) {}"><img style="cursor:pointer; cursor:hand;width: 400px; height: 265px;" src="http://3.bp.blogspot.com/-K2lhkdG6xjI/TZrwPZm9HmI/AAAAAAAAAJQ/i014GAjqvQI/s400/container-less.png" border="0" alt="" id="BLOGGER_PHOTO_ID_5592046034696871522" /></a></div><h3>Consequences</h3><p>The biggest change was the mind-shift. It took some time to get used to the idea that the application is no longer "contained" in something else, but that it can be "self-contained". But there were also a number of other practical consequences that this change entailed:</p><ul><li>simplified development process. It was very easy and fast for developers to run the application in the same way as it would run in production;</li><br /><li>simplified testing. It was very easy to start and stop the application for automated functional tests;</li><br /><li>simplified packaging and deployment process (e.g. no web.xml, no war file, no prescribed directory structure, etc.);</li><br /><li>simplified application start (i.e. simply execute a Java program);</li><br /><li>started using standard DI mechanisms to wire up Jetty as a dependency and injected it where needed.*</li></ul><p>* Strictly speaking, you don't need to ditch the container to do this but we felt that the mind-shift we had gone through enabled us to see the potential for doing this.</p><h3>Conclusion</h3><p>Making this architectural change simplified our development and deployment process. It also simplified the way we thought about the application. The only price we paid was loosing the ability to deploy the application to different web server without making changes. Fortunately, this price was purely hypothetical because we had absolutely no need nor desire to use a different web server in production. On the positive side, we were now hiding the fact that we were relying on Java Servlets to realise our web functionality. In fact, seeing what some of the other communities are building (e.g. Sinatra, Node.js, etc.), I'd be tempted to try to write a web application that doesn't use Servlets at all. Part of it for fun, part of it to overcome some of the limitations inherent with the Servlet model.</p></div>
<h2>Comments</h2>
<div class='comments'>
<div class='comment'>
<div class='author'>website designing development company chennai india</div>
<div class='content'>
I have read this post. collection of post is a nice one ..that am doing  <a href="http://www.anusuyaw3.com/web_designing.php" rel="nofollow"> website designing company chennai india</a> and <a href="http://www.anusuyaw3.com/web_designing.php" rel="nofollow"> website development company chennai india</a>. That I will inform about your post to my friends and all the best for your future posts..</div>
</div>
<div class='comment'>
<div class='author'>Tristan</div>
<div class='content'>
This is exactly what we do on most of our products - and our preferred method.<br />Containers have always made our life more difficult.</div>
</div>
<div class='comment'>
<div class='author'>Jilles</div>
<div class='content'>
Hey Patric!<br /><br />You&#39;re absolutely right. We&#39;re doing something similar with Jetty. <br /><br />In general a lot of Java development seems to be about moving around files rather than doing actual work. A typical maven build can waste most of your day just doing that (bearing in mind any decent IDE already did the actual work of compiling your code, incrementally, within milliseconds of saving). Compilation is of course deterministic enough these days that your build tool is unlikely to come up with a vastly different binary. In other words, it is an expensive waste of time.<br /><br />The whole point of embedded web containers is that you no longer need a build tool. You save your file. The IDE makes sure everything stays in a compiled state, you run your code. Nothing needs to be copied around because it is already there.</div>
</div>
<div class='comment'>
<div class='author'>dirty</div>
<div class='content'>
+1<br /><br />We&#39;ve also found that making the application totally responsible for it&#39;s own lifecycle greatly simplifies testing, deployment and app flexibility, not to mention reducing startup times. Want to add a web gui to a message-driven app? Easy - just embed Jetty (or better yet SimpleWeb (to sidestep the heinous servlet api)) and start it up. No web.xml or ridiculous folder structures required.</div>
</div>
<div class='comment'>
<div class='author'>Felix</div>
<div class='content'>
Great post. What does the container give us?<br /><br />1) Hot deployment<br /><br />2) The ability to deploy more than one app<br /><br />3) Nice class loader isolation<br /><br />4) The ability to configure our app in an xml file using servlet parameters<br /><br />5) The ability to do stop the server using a script<br /><br />6) It servers static files<br /><br />Features 1 to 4 are useless as in I haven&#39;t used them on my last 10 projects 5 to 6 can be implemented by trivial means. So the container essentially is a lot of dead weight. <br /><br />So +10.</div>
</div>
<div class='comment'>
<div class='author'>Patric Fornasier</div>
<div class='content'>
@Graham Just zipped up the jars.</div>
</div>
<div class='comment'>
<div class='author'>Graham Brooks</div>
<div class='content'>
How did you package the application. Did you take the war bundled approach or just zipped up the app and dependencies?</div>
</div>
</div>
